<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
</head>

<body>
    <div class="container-fluid">
        <div class="row">
             <div class="col-md-4 display-5">Cart </div>
                <div class="col-md-2"></div>
                <div class="col-md-2"></div>
                <div class="col-md-2"></div>
                <div class="col-md-1"><button class="btn btn-warning"><a href="dashboard.html" class="text-decoration-none text-dark" >Home</a></button></div>
                <div class="col-md-1"><button onclick="logout()" class="btn btn-danger">Logout</button></div>
        </div>
        <div id="cart-list" class="row"></div>
    </div>

    <script>

        function remove(id){
             let cartItems = JSON.parse(localStorage.getItem('cartList'))  ;

             let index = cartItems.findIndex(product=>product.id === id);

             //cartItems.pop(item);

             cartItems.splice(index, 1);

             localStorage.setItem("cartList", JSON.stringify(cartItems));

             alert('item removed');

             createCartList();
        }
        function createCartList() {
            let cartItems = JSON.parse(localStorage.getItem('cartList')) || alert('Cart is empty');

            let cartList = document.getElementById('cart-list');

            cartList.innerHTML = '';

            cartItems.forEach(item => cartList.innerHTML += `<div class="col-md-4 text-center  p-2" >
         <div class="border rounded border-2 p-4">
          <img src="${item.thumbnail}" />  
          <h2>${item.title} </h2>
          <h3>${item.price}</h3>  

          <button onclick="remove(${item.id})" class="btn btn-primary form-control" >Remove</button>
         </div>
        </div>` )

        }

        createCartList();

        let loggedInUser = JSON.parse(localStorage.getItem("loggedInUser"));

        if(!loggedInUser){
            window.location.href='login.html';
        }
        
        let para = document.getElementById('user');

        para.innerText = `Welcome ${loggedInUser.username}`;

        function logout(){
            localStorage.removeItem("loggedInUser");
            window.location.href = 'login.html';
        }
    </script>
</body>

</html>